-- Suggest performance improvements for the following SQL code.
-- Goals:
-- 1. Identify performance bottlenecks (e.g., loops, suboptimal joins, redundant scans).
-- 2. Propose optimizations like:
--    - Indexing strategies
--    - Converting loops to set-based operations
--    - Rewriting subqueries or joins
--    - Avoiding scalar UDFs or cursors
-- 3. Output the optimized SQL block if applicable.

SQL Input:
{{ input_sql }}

-- Optimized SQL (if transformed) --